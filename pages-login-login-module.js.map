{"version":3,"sources":["./src/app/pages/login/login.module.ts","./src/app/pages/login/login.page.ts","./src/app/pages/login/login.page.html"],"names":[],"mappings":"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","file":"pages-login-login-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { LoginPage } from './login.page';\r\nimport { ComponentsModule } from '../../components/components.module';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: LoginPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes),\r\n    ComponentsModule\r\n  ],\r\n  \r\n  declarations: [LoginPage]\r\n})\r\nexport class LoginPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\nimport { NavController, LoadingController, ToastController, AlertController } from '@ionic/angular';\r\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\r\nimport { ErrorService } from '../../services/error.service';\r\nimport { AuthService } from '../../services/auth.service';\r\nimport { NativeStorage } from '@ionic-native/native-storage/ngx';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\n\r\n@Component({\r\n    selector: 'login',\r\n    templateUrl: './login.page.html',\r\n    styleUrls: ['./login.page.scss'],\r\n})\r\nexport class LoginPage implements OnInit {\r\n\r\n\r\n   \r\n    displayErrorMessage: boolean = false;\r\n    showVerificationCode = false;\r\n    // showPassword: boolean = false;\r\n    //loginFormGroup: FormGroup;\r\n\r\n    public loginFormGroup: FormGroup;\r\n\r\n    constructor(public navController: NavController,\r\n        public loadingCtrl: LoadingController,\r\n        public errorService: ErrorService,\r\n        private toastCtrl: ToastController,\r\n        private formBuilder: FormBuilder,\r\n        private authService: AuthService,\r\n        public loadingController: LoadingController,\r\n        public alertController: AlertController, \r\n        private route: ActivatedRoute) {\r\n\r\n        // this.loginFormGroup = new FormGroup({\r\n        //     email: new FormControl('', Validators.required),\r\n        //     password: new FormControl('',Validators.required),\r\n        //   });\r\n\r\n        this.loginFormGroup = this.formBuilder.group({\r\n            email: [\"\", Validators.compose([Validators.required])],\r\n            password: [\"\", Validators.compose([Validators.required])],\r\n            code: [\"\", Validators.compose([])],\r\n            showPassword: [false]\r\n        });\r\n\r\n        this.showVerificationCode = this.route.snapshot.paramMap.get(\"showcode\") === \"true\" ? true: false;\r\n    }\r\n\r\n\r\n\r\n    async presentLoggedInToast(emailAddress: string) {\r\n        let toast = await this.toastCtrl.create({\r\n            message: \"You have successfully logged in as \" + emailAddress,\r\n            duration: 3000,\r\n            position: \"bottom\"\r\n        });\r\n\r\n        await toast.present();\r\n    }\r\n\r\n    async presentAlert(message: string) {\r\n        const alert = await this.alertController.create({\r\n            header: 'Failed to login',\r\n            message: message,\r\n            buttons: ['OK']\r\n        });\r\n\r\n        await alert.present();\r\n    }\r\n\r\n    async login() {\r\n\r\n        const loading = await this.loadingController.create({\r\n            message: 'Signing in...'\r\n        });\r\n\r\n        await loading.present();\r\n\r\n        // verify code first\r\n        if(this.showVerificationCode) {\r\n            try {\r\n                await this.authService.confirmSignUp(\r\n                    this.loginFormGroup.value.email,\r\n                    this.loginFormGroup.value.code);\r\n            }\r\n            catch (e) {\r\n                this.presentAlert(\"Verification code incorrect\");\r\n                await loading.dismiss();\r\n                return;\r\n            }\r\n        }\r\n\r\n        \r\n        var email = this.loginFormGroup.value.email;\r\n        var password = this.loginFormGroup.value.password;\r\n        var result = await this.authService.signIn(email, password);\r\n        await loading.dismiss();\r\n        if(!result){\r\n            this.presentAlert(\"Incorrect username and/or password\");\r\n        }\r\n        else{\r\n            this.navController.navigateRoot(\"search\");\r\n            await this.presentLoggedInToast(email);\r\n        }\r\n          \r\n    \r\n    }\r\n\r\n    forgotPassword() {\r\n        this.navController.navigateForward(\"forgot-password\");\r\n    }\r\n\r\n    //redirects user to register page\r\n    register() {\r\n        this.navController.navigateForward(\"register\");\r\n    }\r\n\r\n    ngOnInit() {\r\n\r\n    }\r\n\r\n}\r\n","<ion-header>\r\n    <app-topbar title=\"Login\"></app-topbar>\r\n</ion-header>\r\n\r\n<ion-content class=\"login\">\r\n\r\n   \r\n    \r\n\r\n    <form [formGroup]=\"loginFormGroup\" (ngSubmit)=\"login()\" >\r\n\r\n\r\n        <ion-item *ngIf=\"showVerificationCode\" class=\"ion-padding\">\r\n            <ion-label position=\"floating\">Verification code</ion-label>\r\n            <ion-input formControlName=\"code\" type=\"text\"  class=\"form-control\" id=\"code\"></ion-input>\r\n        </ion-item>\r\n\r\n        <ion-item class=\"ion-padding\">\r\n            <ion-label position=\"floating\">Email or username</ion-label>\r\n            <ion-input formControlName=\"email\" type=\"email\"  class=\"form-control\" id=\"email\"></ion-input>\r\n        </ion-item>\r\n        <ion-item class=\"ion-padding\">\r\n            <ion-label  position=\"floating\">password</ion-label>\r\n            <ion-input formControlName=\"password\" type=\"{{loginFormGroup?.value?.showPassword ? 'text' : 'password'}}\" class=\"form-control\" id=\"password\"></ion-input>\r\n        </ion-item>\r\n        <ion-item>\r\n            <ion-label>Show password</ion-label>\r\n            <ion-checkbox slot=\"start\" formControlName=\"showPassword\">Show password</ion-checkbox>\r\n        </ion-item>\r\n\r\n        <ion-button expand=\"full\" class=\"ion-padding\" primary block type=\"submit\" name=\"action\" [disabled]=\"!loginFormGroup.valid\" >\r\n            Login\r\n        </ion-button>\r\n\r\n        <ion-button expand=\"full\" class=\"ion-padding\" primary block fill=\"clear\"  *ngIf=\"!showVerificationCode\" routerLink=\"/login/true\">I have a verification code</ion-button>\r\n        <ion-button expand=\"full\" class=\"ion-padding\" primary block fill=\"clear\" clear  *ngIf=\"showVerificationCode\" routerLink=\"/login\">I have already verified before</ion-button>\r\n\r\n    </form>\r\n\r\n<div style=\"text-align: center\">\r\n    <ion-button fill=\"clear\" class=\"ion-padding\" (click)=\"register()\" secondary name=\"action\">\r\n        Register\r\n    </ion-button>\r\n\r\n    <ion-button fill=\"clear\" class=\"ion-padding\" (click)=\"forgotPassword()\" secondary>Forgot Password</ion-button>\r\n</div>\r\n\r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ion-content>"],"sourceRoot":"webpack:///"}